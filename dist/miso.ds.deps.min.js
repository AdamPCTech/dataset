/**
* Miso.Dataset - v0.1.0 - 3/1/2012
* http://github.com/alexgraul/Dataset
* Copyright (c) 2012 Alex Graul, Irene Ros;
* Licensed MIT, GPL
*/
(function(a,b){function q(a){this._d=a}function r(a,b){var c=a+"";while(c.length<b)c="0"+c;return c}function s(b,c,d,e){var f=typeof c=="string",g=f?{}:c,h,i,j,k;return f&&e&&(g[c]=+e),h=(g.ms||g.milliseconds||0)+(g.s||g.seconds||0)*1e3+(g.m||g.minutes||0)*6e4+(g.h||g.hours||0)*36e5,i=(g.d||g.days||0)+(g.w||g.weeks||0)*7,j=(g.M||g.months||0)+(g.y||g.years||0)*12,h&&b.setTime(+b+h*d),i&&b.setDate(b.getDate()+i*d),j&&(k=b.getDate(),b.setDate(1),b.setMonth(b.getMonth()+j*d),b.setDate(Math.min((new a(b.getFullYear(),b.getMonth()+1,0)).getDate(),k))),b}function t(a){return Object.prototype.toString.call(a)==="[object Array]"}function u(b){return new a(b[0],b[1]||0,b[2]||1,b[3]||0,b[4]||0,b[5]||0,b[6]||0)}function v(b,c){function t(c){var d,i;switch(c){case"M":return e+1;case"Mo":return e+1+p(e+1);case"MM":return r(e+1,2);case"MMM":return moment.monthsShort[e];case"MMMM":return moment.months[e];case"D":return f;case"Do":return f+p(f);case"DD":return r(f,2);case"DDD":return d=new a(g,e,f),i=new a(g,0,1),~~((d-i)/864e5+1.5);case"DDDo":return d=t("DDD"),d+p(d);case"DDDD":return r(t("DDD"),3);case"d":return h;case"do":return h+p(h);case"ddd":return moment.weekdaysShort[h];case"dddd":return moment.weekdays[h];case"w":return d=new a(g,e,f-h+5),i=new a(d.getFullYear(),0,4),~~((d-i)/864e5/7+1.5);case"wo":return d=t("w"),d+p(d);case"ww":return r(t("w"),2);case"YY":return r(g%100,2);case"YYYY":return g;case"a":return l>11?s.pm:s.am;case"A":return l>11?s.PM:s.AM;case"H":return l;case"HH":return r(l,2);case"h":return l%12||12;case"hh":return r(l%12||12,2);case"m":return m;case"mm":return r(m,2);case"s":return n;case"ss":return r(n,2);case"zz":case"z":return(b.toString().match(k)||[""])[0].replace(j,"");case"Z":return(o>0?"+":"-")+r(~~(Math.abs(o)/60),2)+":"+r(~~(Math.abs(o)%60),2);case"ZZ":return(o>0?"+":"-")+r(~~(10*Math.abs(o)/6),4);case"L":case"LL":case"LLL":case"LLLL":case"LT":return v(b,moment.longDateFormat[c]);default:return c.replace(/(^\[)|(\\)|\]$/g,"")}}var d=new q(b),e=d.month(),f=d.date(),g=d.year(),h=d.day(),l=d.hours(),m=d.minutes(),n=d.seconds(),o=-d.zone(),p=moment.ordinal,s=moment.meridiem;return c.replace(i,t)}function w(b,c){function o(a,b){var c;switch(a){case"M":case"MM":d[1]=~~b-1;break;case"MMM":case"MMMM":for(c=0;c<12;c++)if(moment.monthsParse[c].test(b)){d[1]=c;break}break;case"D":case"DD":case"DDD":case"DDDD":d[2]=~~b;break;case"YY":b=~~b,d[0]=b+(b>70?1900:2e3);break;case"YYYY":d[0]=~~Math.abs(b);break;case"a":case"A":k=b.toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":d[3]=~~b;break;case"m":case"mm":d[4]=~~b;break;case"s":case"ss":d[5]=~~b;break;case"Z":case"ZZ":g=!0,c=(b||"").match(n),c&&c[1]&&(e=~~c[1]),c&&c[2]&&(f=~~c[2]),c&&c[0]==="+"&&(e=-e,f=-f)}}var d=[0,0,1,0,0,0,0],e=0,f=0,g=!1,h=b.match(m),i=c.match(l),j,k;for(j=0;j<i.length;j++)o(i[j],h[j]);return k&&d[3]<12&&(d[3]+=12),k===!1&&d[3]===12&&(d[3]=0),d[3]+=e,d[4]+=f,g?new a(a.UTC.apply({},d)):u(d)}function x(a,b){var c=Math.min(a.length,b.length),d=Math.abs(a.length-b.length),e=0,f;for(f=0;f<c;f++)~~a[f]!==~~b[f]&&e++;return e+d}function y(a,b){var c,d=a.match(m),e=[],f=99,g,h,i;for(g=0;g<b.length;g++)h=w(a,b[g]),i=x(d,v(h,b[g]).match(m)),i<f&&(f=i,c=h);return c}function z(a,b,c){var d=moment.relativeTime[a];return typeof d=="function"?d(b||1,!!c,a):d.replace(/%d/i,b||1)}function A(a,b){var d=c(Math.abs(a)/1e3),e=c(d/60),f=c(e/60),g=c(f/24),h=c(g/365),i=d<45&&["s",d]||e===1&&["m"]||e<45&&["mm",e]||f===1&&["h"]||f<22&&["hh",f]||g===1&&["d"]||g<=25&&["dd",g]||g<=45&&["M"]||g<345&&["MM",c(g/30)]||h===1&&["y"]||["yy",h];return i[2]=b,z.apply({},i)}function B(a,b){moment.fn[a]=function(a){return a!=null?(this._d["set"+b](a),this):this._d["get"+b]()}}var moment,c=Math.round,d={},e=typeof module!="undefined",f="months|monthsShort|monthsParse|weekdays|weekdaysShort|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),g,h=/^\/?Date\((\d+)/i,i=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|zz?|ZZ?|LT|LL?L?L?)/g,j=/[^A-Z]/g,k=/\([A-Za-z ]+\)|:[0-9]{2} [A-Z]{3} /g,l=/(\\)?(MM?M?M?|dd?d?d|DD?D?D?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|ZZ?|T)/g,m=/(\\)?([0-9]+|([a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+|([\+\-]\d\d:?\d\d))/gi,n=/([\+\-]|\d\d)/gi,o="1.4.0",p="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|");moment=function(c,d){if(c===null)return null;var e,f;return c&&c._d instanceof a?e=new a(+c._d):d?t(d)?e=y(c,d):e=w(c,d):(f=h.exec(c),e=c===b?new a:f?new a(+f[1]):c instanceof a?c:t(c)?u(c):new a(c)),new q(e)},moment.version=o,moment.lang=function(a,b){var c,g,h,i=[];if(b){for(c=0;c<12;c++)i[c]=new RegExp("^"+b.months[c]+"|^"+b.monthsShort[c].replace(".",""),"i");b.monthsParse=b.monthsParse||i,d[a]=b}if(d[a])for(c=0;c<f.length;c++)g=f[c],moment[g]=d[a][g]||moment[g];else e&&(h=require("./lang/"+a),moment.lang(a,h))},moment.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:{AM:"AM",am:"am",PM:"PM",pm:"pm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10;return~~(a%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th"}}),moment.fn=q.prototype={clone:function(){return moment(this)},valueOf:function(){return+this._d},"native":function(){return this._d},toString:function(){return this._d.toString()},toDate:function(){return this._d},format:function(a){return v(this._d,a)},add:function(a,b){return this._d=s(this._d,a,1,b),this},subtract:function(a,b){return this._d=s(this._d,a,-1,b),this},diff:function(a,b,d){var e=moment(a),f=(this.zone()-e.zone())*6e4,g=this._d-e._d-f,h=this.year()-e.year(),i=this.month()-e.month(),j=this.date()-e.date(),k;return b==="months"?k=h*12+i+j/30:b==="years"?k=h+i/12:k=b==="seconds"?g/1e3:b==="minutes"?g/6e4:b==="hours"?g/36e5:b==="days"?g/864e5:b==="weeks"?g/6048e5:g,d?k:c(k)},from:function(a,b){var c=this.diff(a),d=moment.relativeTime,e=A(c,b);return b?e:(c<=0?d.past:d.future).replace(/%s/i,e)},fromNow:function(a){return this.from(moment(),a)},calendar:function(){var a=this.diff(moment().sod(),"days",!0),b=moment.calendar,c=b.sameElse,d=a<-6?c:a<-1?b.lastWeek:a<0?b.lastDay:a<1?b.sameDay:a<2?b.nextDay:a<7?b.nextWeek:c;return this.format(typeof d=="function"?d.apply(this):d)},isLeapYear:function(){var a=this.year();return a%4===0&&a%100!==0||a%400===0},isDST:function(){return this.zone()<moment([this.year()]).zone()||this.zone()<moment([this.year(),5]).zone()},day:function(a){var b=this._d.getDay();return a==null?b:this.add({d:a-b})},sod:function(){return this.clone().hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})}};for(g=0;g<p.length;g++)B(p[g].toLowerCase(),p[g]);B("year","FullYear"),moment.fn.zone=function(){return this._d.getTimezoneOffset()},e&&(module.exports=moment),typeof window!="undefined"&&(window.moment=moment),typeof define=="function"&&define.amd&&define("moment",[],function(){return moment})})(Date),function(){function z(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&_.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&_.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&z(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(_.has(a,h)){f++;if(!(g=_.has(b,h)&&z(a[h],b[h],c)))break}if(g){for(h in b)if(_.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,_=function(a){return new D(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=_),exports._=_):a._=_,_.VERSION="1.3.1";var w=_.each=_.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(_.has(a,g)&&b.call(d,a[g],g,a)===c)return};_.map=_.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(w(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},_.reduce=_.foldl=_.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=_.bind(b,d)),e?a.reduce(b,c):a.reduce(b);w(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},_.reduceRight=_.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=_.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=_.toArray(a).reverse();return d&&!e&&(b=_.bind(b,d)),e?_.reduce(f,b,c,d):_.reduce(f,b)},_.find=_.detect=function(a,b,c){var d;return x(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},_.filter=_.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(w(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},_.reject=function(a,b,c){var d=[];return a==null?d:(w(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},_.every=_.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(w(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var x=_.some=_.any=function(a,b,d){b||(b=_.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(w(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};_.include=_.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=x(a,function(a){return a===b}),c)},_.invoke=function(a,b){var c=g.call(arguments,2);return _.map(a,function(a){return(_.isFunction(b)?b||a:a[b]).apply(a,c)})},_.pluck=function(a,b){return _.map(a,function(a){return a[b]})},_.max=function(a,b,c){if(!b&&_.isArray(a))return Math.max.apply(Math,a);if(!b&&_.isEmpty(a))return-Infinity;var d={computed:-Infinity};return w(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},_.min=function(a,b,c){if(!b&&_.isArray(a))return Math.min.apply(Math,a);if(!b&&_.isEmpty(a))return Infinity;var d={computed:Infinity};return w(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},_.shuffle=function(a){var b=[],c;return w(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},_.sortBy=function(a,b,c){return _.pluck(_.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},_.groupBy=function(a,b){var c={},d=_.isFunction(b)?b:function(a){return a[b]};return w(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},_.sortedIndex=function(a,b,c){c||(c=_.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},_.toArray=function(a){return a?a.toArray?a.toArray():_.isArray(a)?g.call(a):_.isArguments(a)?g.call(a):_.values(a):[]},_.size=function(a){return _.toArray(a).length},_.first=_.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},_.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},_.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},_.rest=_.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},_.compact=function(a){return _.filter(a,function(a){return!!a})},_.flatten=function(a,b){return _.reduce(a,function(a,c){return _.isArray(c)?a.concat(b?c:_.flatten(c)):(a[a.length]=c,a)},[])},_.without=function(a){return _.difference(a,g.call(arguments,1))},_.uniq=_.unique=function(a,b,c){var d=c?_.map(a,c):a,e=[];return _.reduce(d,function(c,d,f){if(0==f||(b===!0?_.last(c)!=d:!_.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=_.intersect=function(a){var b=g.call(arguments,1);return _.filter(_.uniq(a),function(a){return _.every(b,function(b){return _.indexOf(b,a)>=0})})},_.difference=function(a){var b=_.flatten(g.call(arguments,1));return _.filter(a,function(a){return!_.include(b,a)})},_.zip=function(){var a=g.call(arguments),b=_.max(_.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=_.pluck(a,""+d);return c},_.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=_.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},_.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},_.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var y=function(){};_.bind=function(a,b){var c,d;if(a.bind===v&&v)return v.apply(a,g.call(arguments,1));if(!_.isFunction(a))throw new TypeError;return d=g.call(arguments,2),c=function(){if(this instanceof c){y.prototype=a.prototype;var e=new y,f=a.apply(e,d.concat(g.call(arguments)));return Object(f)===f?f:e}return a.apply(b,d.concat(g.call(arguments)))}},_.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=_.functions(a)),w(b,function(b){a[b]=_.bind(a[b],a)}),a},_.memoize=function(a,b){var c={};return b||(b=_.identity),function(){var d=b.apply(this,arguments);return _.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},_.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},_.defer=function(a){return _.delay.apply(_,[a,1].concat(g.call(arguments,1)))},_.throttle=function(a,b){var c,d,e,f,g,h=_.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},_.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},_.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},_.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},_.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},_.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},_.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)_.has(a,c)&&(b[b.length]=c);return b},_.values=function(a){return _.map(a,_.identity)},_.functions=_.methods=function(a){var b=[];for(var c in a)_.isFunction(a[c])&&b.push(c);return b.sort()},_.extend=function(a){return w(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},_.defaults=function(a){return w(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},_.clone=function(a){return _.isObject(a)?_.isArray(a)?a.slice():_.extend({},a):a},_.tap=function(a,b){return b(a),a},_.isEqual=function(a,b){return z(a,b,[])},_.isEmpty=function(a){if(_.isArray(a)||_.isString(a))return a.length===0;for(var b in a)if(_.has(a,b))return!1;return!0},_.isElement=function(a){return!!a&&a.nodeType==1},_.isArray=t||function(a){return i.call(a)=="[object Array]"},_.isObject=function(a){return a===Object(a)},_.isArguments=function(a){return i.call(a)=="[object Arguments]"},_.isArguments(arguments)||(_.isArguments=function(a){return!!a&&!!_.has(a,"callee")}),_.isFunction=function(a){return i.call(a)=="[object Function]"},_.isString=function(a){return i.call(a)=="[object String]"},_.isNumber=function(a){return i.call(a)=="[object Number]"},_.isNaN=function(a){return a!==a},_.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},_.isDate=function(a){return i.call(a)=="[object Date]"},_.isRegExp=function(a){return i.call(a)=="[object RegExp]"},_.isNull=function(a){return a===null},_.isUndefined=function(a){return a===void 0},_.has=function(a,b){return j.call(a,b)},_.noConflict=function(){return a._=b,this},_.identity=function(a){return a},_.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},_.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},_.mixin=function(a){w(_.functions(a),function(b){F(b,_[b]=a[b])})};var A=0;_.uniqueId=function(a){var b=A++;return a?a+b:b},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/.^/,C=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};_.template=function(a,b){var c=_.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||B,function(a,b){return"',_.escape("+C(b)+"),'"}).replace(c.interpolate||B,function(a,b){return"',"+C(b)+",'"}).replace(c.evaluate||B,function(a,b){return"');"+C(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,_):function(a){return e.call(this,a,_)}},_.chain=function(a){return _(a).chain()};var D=function(a){this._wrapped=a};_.prototype=D.prototype;var E=function(a,b){return b?_(a).chain():a},F=function(a,b){D.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),E(b.apply(_,a),this._chain)}};_.mixin(_),w(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];D.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],E(c,this._chain)}}),w(["concat","join","slice"],function(a){var b=d[a];D.prototype[a]=function(){return E(b.apply(this._wrapped,arguments),this._chain)}}),D.prototype.chain=function(){return this._chain=!0,this},D.prototype.value=function(){return this._wrapped}}.call(this),function(){var a=this.math={};a.mean=a.ave=a.average=function(b,c){return a.sum(b,c)/_(b).size()},a.median=function(b){var c=(b.length+1)/2,d=a.sort(b);return d.length%2?d[c-1]:(d[c-1.5]+d[c-.5])/2},a.pow=function(a,b){if(_.isNumber(a))return Math.pow(a,b);if(_.isArray(a))return _.map(a,function(a){return _.pow(a,b)})},a.scale=function(a,b){var b=b||1,c=_.max(a);return _.map(a,function(a){return a*(b/c)})},a.slope=function(a,b){return(b[1]-a[1])/(b[0]-a[0])},a.sort=function(a){return a.sort(function(a,b){return a-b})},a.stdDeviation=a.sigma=function(a){return Math.sqrt(_(a).variance())},a.sum=function(a,b){if(_.isArray(a)&&typeof a[0]=="number")var c=a;else var b=b||"value",c=_(a).pluck(b);var d=0;for(var e=0,f=c.length;e<f;e++)d+=c[e];return d},a.transpose=function(a){var b=[];return _(a).each(function(a,c){_(a).each(function(a,d){b[d]||(b[d]=[]),b[d][c]=a})}),b},a.variance=function(a){var b=_(a).mean();return _(a).chain().map(function(a){return _(a-b).pow(2)}).mean().value()},_.mixin(a)}(),function(a){function q(a){var b=p[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var b={},c=Array.prototype,d=Object.prototype,e=d.hasOwnProperty,f=d.toString,g=c.forEach,h=c.slice,i=function(a,c,d){var f,h,i;if(!a)return;if(g&&a.forEach===g)a.forEach(c,d);else if(a.length===+a.length){for(h=0,i=a.length;h<i;h++)if(h in a&&c.call(d,a[h],h,a)===b)return}else for(f in a)if(e.call(a,f)&&c.call(d,a[f],f,a)===b)return},j=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},k=function(a){return i(h.call(arguments,1),function(b){var c;for(c in b)b[c]!==void 0&&(a[c]=b[c])}),a},l={"[object Array]":"array","[object Function]":"function"},m=function(a){return a?l[f.call(a)]||"object":String(a)},n="done fail isResolved isRejected promise then always pipe".split(" "),o={},p={};o.Callbacks=function(a){a=a?p[a]||q(a):{};var b=[],c=[],d,e,f,g,h,i=function(c){var d,e,f,g,h;for(d=0,e=c.length;d<e;d++)f=c[d],g=m(f),g==="array"?i(f):g==="function"&&(!a.unique||!k.has(f))&&b.push(f)},j=function(i,j){j=j||[],d=!a.memory||[i,j],e=!0,h=f||0,f=0,g=b.length;for(;b&&h<g;h++)if(b[h].apply(i,j)===!1&&a.stopOnFalse){d=!0;break}e=!1,b&&(a.once?d===!0?k.disable():b=[]:c&&c.length&&(d=c.shift(),k.fireWith(d[0],d[1])))},k={add:function(){if(b){var a=b.length;i(arguments),e?g=b.length:d&&d!==!0&&(f=a,j(d[0],d[1]))}return this},remove:function(){if(b){var c=arguments,d=0,f=c.length;for(;d<f;d++)for(var i=0;i<b.length;i++)if(c[d]===b[i]){e&&i<=g&&(g--,i<=h&&h--),b.splice(i--,1);if(a.unique)break}}return this},has:function(a){if(b){var c=0,d=b.length;for(;c<d;c++)if(a===b[c])return!0}return!1},empty:function(){return b=[],this},disable:function(){return b=c=d=undefined,this},disabled:function(){return!b},lock:function(){return c=undefined,(!d||d===!0)&&k.disable(),this},locked:function(){return!c},fireWith:function(b,f){return c&&(e?a.once||c.push([b,f]):(!a.once||!d)&&j(b,f)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},o.Deferred=function(a){var b=o.Callbacks("once memory"),c=o.Callbacks("once memory"),d=o.Callbacks("memory"),e="pending",f={resolve:b,reject:c,notify:d},g={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){return h.done(a).fail(b).progress(c),this},always:function(){return h.done.apply(h,arguments).fail.apply(h,arguments),this},pipe:function(a,b,c){return o.Deferred(function(d){i({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=a[0],e=a[1],f;j(c)?h[b](function(){f=c.apply(this,arguments),f&&j(f.promise)?f.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===h?d:this,[f])}):h[b](d[e])})}).promise()},promise:function(a){if(!a)a=g;else for(var b in g)a[b]=g[b];return a}},h=g.promise({}),k;for(k in f)h[k]=f[k].fire,h[k+"With"]=f[k].fireWith;return h.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(h,h),h},o.when=function(a){function l(a){return function(c){b[a]=arguments.length>1?h.call(arguments,0):c,--f||i.resolveWith(i,b)}}function m(a){return function(b){e[a]=arguments.length>1?h.call(arguments,0):b,i.notifyWith(k,e)}}var b=h.call(arguments,0),c=0,d=b.length,e=new Array(d),f=d,g=d,i=d<=1&&a&&j(a.promise)?a:o.Deferred(),k=i.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&j(b[c].promise)?b[c].promise().then(l(c),i.reject,m(c)):--f;f||i.resolveWith(i,b)}else i!==a&&i.resolveWith(i,d?[a]:[]);return k},typeof module!="undefined"&&module.exports?module.exports=o:typeof a._!="undefined"?a._.mixin(o):a._=o}(this),function(a,_){var b=a.Miso={};b.typeOf=function(a,c){var d=_.keys(b.types),e;return d.push(d.splice(_.indexOf(d,"string"),1)[0]),e=_.find(d,function(d){return b.types[d].test(a,c)}),e=_.isUndefined(e)?"string":e,e},b.types={string:{name:"string",coerce:function(a){return _.isNull(a)?null:a.toString()},test:function(a){return typeof a=="string"},compare:function(a,b){return a<b?-1:a>b?1:0},numeric:function(a,b){return b}},"boolean":{name:"boolean",regexp:/^(true|false)$/,coerce:function(a){return a==="false"?!1:Boolean(a)},test:function(a){return typeof a=="boolean"||this.regexp.test(a)?!0:!1},compare:function(a,b){return a===b?0:a<b?-1:1},numeric:function(a){return a?1:0}},number:{name:"number",regexp:/^[\-\.]?[0-9]+([\.][0-9]+)?$/,coerce:function(a){return _.isNull(a)?null:(a=Number(a),_.isNaN(a)?null:a)},test:function(a){return typeof a=="number"||this.regexp.test(a)?!0:!1},compare:function(a,b){return a===b?0:a<b?-1:1},numeric:function(a){return a}},time:{name:"time",format:"DD/MM/YYYY",_formatLookup:[["DD","\\d{2}"],["MM","\\d{2}"],["YYYY","\\d{4}"],["YY","\\d{2}"]],_regexpTable:{},_regexp:function(a){if(this._regexpTable[a])return new RegExp(this._regexpTable[a],"g");var b=a;return _.each(this._formatLookup,function(a){b=b.replace(a[0],a[1])},this),b=b.split("/").join("\\/"),this._regexpTable[a]=b,new RegExp(this._regexpTable[a],"g")},coerce:function(a,b){b=b||{};if(_.isString(a)){var c=b.format||this.format;return moment(a,b.format)}return _.isNumber(a)?moment(a):a},test:function(a,b){b=b||{};if(_.isString(a)){var c=b.format||this.format,d=this._regexp(c);return d.test(a)}return!0},compare:function(a,b){return a<b?-1:a>b?1:0},numeric:function(a){return a.valueOf()}}}}(this,_),function(a,_){var b=a.Miso||(a.Miso={});b.Event=function(a){_.isArray(a)||(a=[a]),this.deltas=a},_.extend(b.Event.prototype,{affectedColumns:function(){var a=[];return _.each(this.deltas,function(b){a=_.union(a,_.keys(b.old),_.keys(b.changed))}),a}}),_.extend(b.Event,{isDelete:function(a){return _.isUndefined(a.changed)||_.keys(a.changed).length===0?!0:!1},isAdd:function(a){return _.isUndefined(a.old)||_.keys(a.old).length===0?!0:!1},isUpdate:function(a){return!this.isDelete(a)&&!this.isAdd(a)?!0:!1}}),b.Events={},b.Events.bind=function(a,b,c){var d=this._callbacks||(this._callbacks={}),e=d[a]||(d[a]={}),f=e.tail||(e.tail=e.next={});return f.callback=b,f.context=c,e.tail=f.next={},this},b.Events.unbind=function(a,b){var c,d,e;if(!a)this._callbacks=null;else if(c=this._callbacks)if(!b)c[a]={};else if(d=c[a])while((e=d)&&(d=d.next)){if(d.callback!==b)continue;e.next=d.next,d.context=d.callback=null;break}return this},b.Events.trigger=function(a){var b,c,d,e,f,g=["all",a];if(!(c=this._callbacks))return this;while(f=g.pop()){if(!(b=c[f]))continue;e=f==="all"?arguments:Array.prototype.slice.call(arguments,1);while(b=b.next)(d=b.callback)&&d.apply(b.context||this,e)}return this},b.Events._buildEvent=function(a){return new b.Event(a)}}(this,_),function(a,_){var b=a.Miso;b.Column=function(a){return this._id=a.id||_.uniqueId(),this.name=a.name,this.type=a.type,this.data=a.data||[],this},_.extend(b.Column.prototype,{toNumeric:function(a,c){return b.types[this.type].numeric(a,c)},numericAt:function(a){return this.toNumeric(this.data[a],a)},coerce:function(){this.data=_.map(this.data,function(a){return b.types[this.type].coerce(a,this.typeOptions)},this)},sum:function(){return _.sum(this.data)},mean:function(){return _.mean(this.data)},median:function(){return _.median(this.data)},max:function(){var a=-Infinity;for(var c=0;c<this.data.length;c++)b.types[this.type].compare(this.data[c],a)>0&&(a=this.numericAt(c));return a},min:function(){var a=Infinity;for(var c=0;c<this.data.length;c++)b.types[this.type].compare(this.data[c],a)<0&&(a=this.numericAt(c));return a}}),b.View=function(a){a=a||(a={});if(_.isUndefined(a.parent))throw new Error("A view must have a parent specified.");return this.parent=a.parent,this._initialize(a),this},_.extend(b.View.prototype,{_initialize:function(a){this.parent.syncable===!0&&(_.extend(this,b.Events),this.syncable=!0),this.filter={columns:this._columnFilter(a.filter.columns||undefined),rows:this._rowFilter(a.filter.rows||undefined)},this._columns=this._selectData();var c=new b.Parsers;_.extend(this,c._cacheColumns(this),c._cacheRows(this)),this.syncable&&this.parent.bind("change",this.sync,this)},sync:function(a){var c=a.deltas;_.each(c,function(c,d){var e=this._rowPositionById[c._id];if(typeof e=="undefined"&&b.Event.isAdd(c))this.filter.rows&&this.filter.rows(c.changed)&&this._add(c.changed);else{if(e==="undefined")return;_.each(c.changed,function(a,b){var c=this._columnPositionByName[b];if(_.isUndefined(c))return;this._columns[c].data[e]=a},this)}var f=this.rowByPosition(e);if(b.Event.isDelete(c)||this.filter.row&&!this.filter.row(f)){var g={_id:c._id,old:this.rowByPosition(e),changed:{}};a.deltas.splice(d,1,g),this._remove(e)}},this),this.syncable&&this.trigger("change",a)},where:function(a,c){return c=c||{},c.parent=this,c.filter=a||{},new b.View(c)},_selectData:function(){var a=[];return _.each(this.parent._columns,function(b){this.filter.columns(b)&&a.push({name:b.name,data:[],type:b.type,_id:b._id})},this),this.parent.each(function(b){if(!this.filter.rows(b))return;for(var c=0;c<a.length;c++)a[c].data.push(b[a[c].name])},this),a},_columnFilter:function(a){var b;return _.isUndefined(a)?b=function(){return!0}:(a.push("_id"),b=function(b){return _.indexOf(a,b.name)===-1?!1:!0}),b},_rowFilter:function(a){var b;return _.isNumber(a)&&(a=[a]),_.isUndefined(a)?b=function(){return!0}:_.isFunction(a)?b=a:b=function(b){return _.indexOf(a,b._id)===-1?!1:!0},b},column:function(a){return this._column(a)},_column:function(a){var b=this._columnPositionByName[a];return this._columns[b]},columns:function(a){return new b.View({filter:{columns:a},parent:this})},columnNames:function(){var a=_.pluck(this._columns,"name");return a.shift(),a},each:function(a,b){for(var c=0;c<this.length;c++)a.apply(b||this,[this.rowByPosition(c),c])},eachColumn:function(a,b){for(var c=1;c<this.length;c++)a.apply(b||this,[this._columns[c].name,c])},rowByPosition:function(a){return this._row(a)},rowById:function(a){return this._row(this._rowPositionById[a])},_row:function(a){var b={};return _.each(this._columns,function(c){b[c.name]=c.data[a]}),b},_remove:function(a){var b=this._rowPositionById[a];return _.each(this._columns,function(a){a.data.splice(b,1)}),delete this._rowPositionById[a],this._rowIdByPosition.splice(b,1),this.length--,this},_add:function(a,b){if(_.isUndefined(this.comparator))_.each(this._columns,function(b){b.data.push(a[b.name]?a[b.name]:null)}),this._rowIdByPosition.push(a._id),this._rowPositionById[a._id]=this._rowIdByPosition.length;else{var c=function(a,b,c){Array.prototype.splice.apply(c,[a,0].concat(b))},d;for(d=0;d<this.length;d++){var e=this.rowByPosition(d);if(this.comparator(a,e)<0){_.each(this._columns,function(b){c(d,a[b.name]?a[b.name]:null,b.data)});break}}this._rowIdByPosition=[],this._rowPositionById={},this.each(function(a,b){this._rowIdByPosition.push(a._id),this._rowPositionById[a._id]=b})}return this.length++,this},rows:function(a){return new b.View({filter:{rows:a},parent:this})},sort:function(a){a=a||{};if(_.isUndefined(this.comparator))throw new Error("Cannot sort without this.comparator.");var b=this.length,c;if(b===1)return;var d=_.bind(function(a,b){var c=this.rowByPosition(b);_.each(c,function(c,d){var e=this._columnPositionByName[d],f=this._columns[e].data[a];this._columns[e].data.splice(a,1,c),this._columns[e].data.splice(b,1,f)},this)},this),e=_.bind(function(a,b){var c=a,e;while(c*2<=b){e=c*2;var f=this.rowByPosition(c);e+1<b&&this.comparator(this.rowByPosition(e),this.rowByPosition(e+1))<0&&e++;if(this.comparator(f,this.rowByPosition(e))<0)d(c,e),c=e;else return}},this),f=function(a){var b=Math.round((a-2)/2);while(b>=0)e(b,a-1),b--};if(b>2){f(b),c=b-1;while(c>1)d(c,0),c--,e(0,c)}else this.comparator(this.rowByPosition(0),this.rowByPosition(1))>0&&d(0,1);this.syncable&&this.trigger("sort")}})}(this,_),function(a,_,moment){var b=a.Miso;b.Dataset=function(a){return a=a||(a={}),this._initialize(a),this},_.extend(b.Dataset.prototype,b.View.prototype,{_initialize:function(a){a.sync===!0&&(_.extend(this,b.Events),this.syncable=!0),this.importer=a.importer||null,this.parser=a.parser||b.Parsers.Obj,_.isUndefined(a.parser)&&(a.strict?this.parser=b.Parsers.Strict:a.delimiter?this.parser=b.Parsers.Delimited:a.google_spreadsheet&&(this.parser=b.Parsers.GoogleSpreadsheet));var c=_.extend({},a,{parser:this.parser});a.delimiter&&(c.dataType="text"),a.google_spreadsheet&&_.extend(c,a.google_spreadsheet),this.importer===null&&(a.url?this.importer=b.Importers.Remote:a.google_spreadsheet?(this.importer=b.Importers.GoogleSpreadsheet,delete a.google_spreadsheet):this.importer=b.Importers.Local),this.importer=new this.importer(c),a.comparator&&(this.comparator=a.comparator),a.ready&&(this.ready=a.ready),a.deferred&&(this.deferred=a.deferred)},fetch:function(a){a=a||{};var b=this.deferred||new _.Deferred;return this.importer!==null&&this.importer.fetch({success:_.bind(function(c){_.extend(this,c),this.comparator&&this.sort(),this.ready&&this.ready.call(this),a.success&&a.success.call(this),b.resolve(this)},this),error:_.bind(function(c){a.error&&a.error.call(this),b.reject(c)},this)}),b.promise()},add:function(a,b){a._id||(a._id=_.uniqueId()),this._add(a,b),this.syncable&&(!b||!b.silent)&&(this.trigger("add",this._buildEvent({changed:a})),this.trigger("change",this._buildEvent({changed:a})))},remove:function(a,b){a=this._rowFilter(a);var c=[];this.each(function(b,d){a(b)&&(this._remove(b._id),c.push({old:b}))});if(this.syncable&&(!b||!b.silent)){var d=this._buildEvent(c);this.trigger("change",d),this.trigger("remove",d)}},update:function(a,c,d){a=this._rowFilter(a);var e=_.keys(c),f=[];this.each(function(d,g){a(d)&&(_.each(this._columns,function(a){if(_.indexOf(e,a.name)!==-1){var d=b.types[a.type];if(d)if(b.typeOf(c[a.name],a.typeOptions)===a.type)c[a.name]=d.coerce(c[a.name],a.typeOptions);else throw"incorrect value '"+c[a.name]+"' of type "+b.typeOf(c[a.name],a.typeOptions)+" passed to column with type "+a.type;a.data[g]=c[a.name]}},this),f.push({_id:d._id,old:d,changed:c}))},this);if(this.syncable&&(!d||!d.silent)){var g=this._buildEvent(f);this.trigger("change",g),this.trigger("remove",g)}}})}(this,_,moment),function(a,_){var b=a.Miso,c=(b.Product||function(){return b.Product=function(a){a=a||(a={}),this.func=a.func;if(a.columns){var b=a.columns;_.isArray(a.columns)&&(b=a.columns[0]),this.valuetype=b.type,this.numeric=function(){return b.toNumeric(this.value)}}return this.func({silent:!0}),this},b.Product})();_.extend(c.prototype,b.Events,{sync:function(a){this.func()},val:function(){return this.value},type:function(){return this.valuetype},_buildDelta:function(a,b){return{old:a,changed:b}}}),_.extend(b.Dataset.prototype,{_findColumns:function(a){var b=[];return _.isUndefined(a)&&(a=this.columnNames()),a=_.isArray(a)?a:[a],_.each(a,function(a){a=this._columns[this._columnPositionByName[a]],b.push(a)},this),b},sum:function(a,b){b=b||{};var c=this._findColumns(a),d=function(a){return function(){return _.sum(_.map(a,function(a){return a.sum()}))}}(c);return this.calculated(c,d)},max:function(a,c){c=c||{};var d=this._findColumns(a),e=function(a){return function(){var c=_.max(_.map(a,function(a){return a.max()})),d=a[0].type,e=a[0].typeOptions;return b.types[d].coerce(c,e)}}(d);return this.calculated(d,e)},min:function(a,c){c=c||{};var d=this._findColumns(a),e=function(a){return function(){var c=_.min(_.map(a,function(a){return a.min()})),d=a[0].type,e=a[0].typeOptions;return b.types[d].coerce(c,e)}}(d);return this.calculated(d,e)},mean:function(a,c){c=c||{};var d=this._findColumns(a),e=function(a){return function(){var c=[];_.each(a,function(a){c.push(a.data)}),c=_.flatten(c);var d=a[0].type,e=a[0].typeOptions;return c=_.map(c,function(a){return b.types[d].numeric(a)}),b.types[d].coerce(_.mean(c),e)}}(d);return this.calculated(d,e)},median:function(a,b){},calculated:function(a,b){var d=this,e=new c({columns:a,func:function(a){a=a||{};var c=this._buildDelta(this.value,b.apply(d));this.value=c.changed;if(d.syncable){var e=this._buildEvent(c);!_.isUndefined(c.old)&&!a.silent&&c.old!==c.changed&&this.trigger("change",e)}}});return this.syncable?(this.bind("change",e.sync,e),e):b()}})}(this,_),function(a,_){var b=a.Miso=a.Miso||{};_.extend(a.Miso.Dataset.prototype,{movingAverage:function(a,b){},groupBy:function(a,c,d){d=d||{};var e=d.method||_.sum,f={_columns:[]};d&&d.preprocess&&(this.preprocess=d.preprocess);var g=new b.Parsers,h=_.union([a],c);_.each(h,function(a){var b=f._columns.push(_.clone(this._columns[this._columnPositionByName[a]]));f._columns[f._columns.length-1].data=[]},this),f=g._cacheColumns(f);var i={},j=0,k=f._columnPositionByName[a];for(var l=0;l<this.length;l++){var m=null;this.preprocess?m=this.preprocess(this._columns[this._columnPositionByName[a]].data[l]):m=this._columns[this._columnPositionByName[a]].data[l],_.isUndefined(i[m])&&(i[m]=j,_.each(c,function(a){var b=f._columns[f._columnPositionByName[a]];b.data[j]=[]}),f._columns[f._columnPositionByName[a]].data[j]=m,j++),_.each(c,function(a){var b=f._columns[f._columnPositionByName[a]],c=this._columns[this._columnPositionByName[a]].data[l],d=i[m];b.data[d].push(c)},this)}_.each(c,function(a){var b=f._columns[f._columnPositionByName[a]];_.each(b.data,function(a,c){_.isArray(a)&&(b.data[c]=e.call(this,a))})},this),f.columns=f._columns,delete f._columns;var n=new b.Dataset({data:f,strict:!0}),o=null;return n.fetch({success:function(){o=this}}),o}})}(this,_),function(a,_){var b=a.Miso||(a.Miso={});b.Parsers=function(){},_.extend(b.Parsers.prototype,{_buildColumn:function(a,c,d){return _.isObject(a)&&arguments.length===1?new b.Column(a):new b.Column({name:a,type:c,data:d})},build:function(a){var b={};return this._buildColumns(b),this._setTypes(b,this.options),this._detectTypes(b),this._coerceTypes(b),this._cacheColumns(b),this._cacheRows(b),b},_coerceTypes:function(a){return _.each(a._columns,function(a,b){a.coerce()}),a},_setTypes:function(a,b){b.columnTypes=b.columnTypes||{},_.each(a._columns,function(a){var c=b.columnTypes[a.name];c&&(_.isObject(c)?(a.type=c.type,delete c.type,a.typeOptions=c):a.type=c)})},_addValue:function(a,b,c){var d=a._columnPositionByName[b];a._columns[d].data.push(c)},_detectTypes:function(a,c){return _.each(a._columns,function(a){if(_.isUndefined(a.type)||a.type===null){var d=_.inject(a.data.slice(0,c||5),function(a,c){var d=b.typeOf(c);return c!==""&&a.indexOf(d)===-1&&!_.isNull(c)&&a.push(d),a},[]);if(d.length===1)a.type=d[0];else if(d.length===0)a.type="number";else throw new Error("This column seems to have mixed types")}}),a},_cacheColumns:function(a){return a._columnPositionByName={},_.each(a._columns,function(b,c){a._columnPositionByName[b.name]=c}),a},_cacheRows:function(a){a._rowPositionById={},a._rowIdByPosition=[],_.each(a._columns[a._columnPositionByName._id].data,function(b,c){a._rowPositionById[b]=c,a._rowIdByPosition.push(b)});var b=_.uniq(_.map(a._columns,function(a){return a.data.length}));if(b.length>1)throw new Error("Row lengths need to be the same. Empty values should be set to null."+_.map(a._columns,function(a){return a.data+"|||"}));return a.length=b[0],a},_addIdColumn:function(a,b){var c=[];return b&&b>0&&_.times(b,function(){c.push(_.uniqueId())}),a._columns.unshift(this._buildColumn("_id","number",c)),a},parse:function(a){return a}}),b.Parsers.Strict=function(a,b){this.options=b||{},this._data=this.parse(a)},_.extend(b.Parsers.Strict.prototype,b.Parsers.prototype,{_buildColumns:function(a){return a._columns=[],_.each(this._data._columns,function(b){a._columns.push(this._buildColumn(b))},this),_.pluck(a._columns,"name").indexOf("_id")===-1&&this._addIdColumn(a,a._columns[0].data.length),a}}),b.Parsers.Obj=function(a,b){this.options=b||{},this._data=a},_.extend(b.Parsers.Obj.prototype,b.Parsers.prototype,{_buildColumns:function(a,b){a._columns=[];var c=_.keys(this._data[0]);return _.each(c,function(b){a._columns.push(this._buildColumn(b,null))},this),this._addIdColumn(a),this._cacheColumns(a),_.map(this._data,function(b){_.each(b,function(b,c){this._addValue(a,c,b)},this),this._addValue(a,"_id",_.uniqueId())},this),a},build:function(a){var b={};return this._buildColumns(b),this._setTypes(b,this.options),this._detectTypes(b),this._coerceTypes(b),this._cacheRows(b),b}});var c={url:"",data:"",dataType:"",success:function(){},type:"GET",async:!0,xhr:function(){return new a.XMLHttpRequest}},d=/\?/;b.Xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;if(!(!a.dataType||a.dataType!=="jsonp"&&a.dataType!=="script")){b.Xhr.getJSONP(a.url,a.success,a.dataType==="script",a.error);return}var e=_.extend({},c,a);e.ajax=e.xhr();if(e.ajax)return e.type==="GET"&&e.data&&(e.url+=(d.test(e.url)?"&":"?")+e.data,e.data=null),e.ajax.open(e.type,e.url,e.async),e.ajax.send(e.data||null),b.Xhr.httpData(e)},b.Xhr.getJSONP=function(a,b,c,d){if(c){var e=document.querySelectorAll('script[src="'+a+'"]');if(e.length){b&&b(!0);return}}var f=document.head||document.getElementsByTagName("head")[0]||document.documentElement,g=document.createElement("script"),h=a.split("?")[1],i=!1,j=[],k,l,m;h&&!c&&(j=h.split("&")),j.length&&(l=j[j.length-1].split("=")),k=j.length?l[1]?l[1]:l[0]:"jsonp",!h&&!c&&(a+="?callback="+k),k&&!c&&(!window[k]||(k=k+ +(new Date)+_.uniqueId()),window[k]=function(a){b&&b(a),i=!0},a=a.replace(l.join("="),l[0]+"="+k)),g.onload=g.onreadystatechange=function(){if(!g.readyState||/loaded|complete/.test(g.readyState))c&&b&&b(),i&&(delete window[k],f.removeChild(g))},g.onerror=function(a){d&&d.call(null)},g.src=a,f.insertBefore(g,f.firstChild);return},b.Xhr.httpData=function(a){var b,c=null;return a.ajax.onreadystatechange=function(){if(a.ajax.readyState===4){try{c=JSON.parse(a.ajax.responseText)}catch(d){}b={xml:a.ajax.responseXML,text:a.ajax.responseText,json:c},a.dataType&&(b=b[a.dataType]),/(2..)/.test(a.ajax.status)?a.success.call(a.ajax,b):a.error&&a.error.call(null,a.ajax.statusText)}},b},b.Importers=function(a,b){},b.Importers.prototype.extract=function(a){return a=_.clone(a),a._columns=a.columns,delete a.columns,a},b.Importers.Local=function(a){this.options=a||(a={}),this.options.extract&&(this.extract=this.options.extract),this.data=a.data,this.parser=this.options.parser||b.Importer.Obj},_.extend(b.Importers.Local.prototype,b.Importers.prototype,{fetch:function(a){this.data=this.extract(this.data),this.parser=new this.parser(this.data,_.extend({},this.options,a));var b=this.parser.build();a.success(b)}}),b.Importers.Remote=function(a){a=a||{},this._url=a.url,a.extract&&(this.extract=a.extract),this.parser=a.parser||b.Parsers.Obj,this.params={type:"GET",url:this._url,dataType:a.dataType?a.dataType:a.jsonp?"jsonp":"json"}},_.extend(b.Importers.Remote.prototype,b.Importers.prototype,{fetch:function(a){var c=_.bind(function(b){b=this.extract(b),this.parser=new this.parser(b,a);var c=this.parser.build();a.success(c)},this);b.Xhr(_.extend(this.params,{success:c,error:a.error}))}})}(this,_),function(a,_){var b=a.Miso||(a.Miso={});b.Parsers.GoogleSpreadsheet=function(a,b){this.options=b||{},this._data=a},_.extend(b.Parsers.GoogleSpreadsheet.prototype,b.Parsers.prototype,{_buildColumns:function(a,b){a._columns=[];var c=/([A-Z]+)(\d+)/,d={};return _.each(this._data.feed.entry,function(b,e){var f=c.exec(b.title.$t),g=f[1],h=parseInt(f[2],10);if(_.isUndefined(d[g]))d[g]=a._columns.length,a._columns.push(this._buildColumn(b.content.$t,null,[]));else{var i=d[g];a._columns[i].data[h-1]=b.content.$t}},this),a.length=_.max(a._columns,function(a){return a.data.length}).data.length-1,_.each(a._columns,function(b,c){b.data.splice(0,1);for(var d=0;d<a.length;d++)if(_.isUndefined(b.data[d])||b.data[d]==="")b.data[d]=null}),_.pluck(a._columns,"name").indexOf("_id")===-1&&this._addIdColumn(a,a._columns[0].data.length),a}}),b.Importers.GoogleSpreadsheet=function(a){a=a||{};if(a.url)a.url=a.url;else{if(_.isUndefined(a.key))throw new Error("Set options.key to point to your google document.");a.worksheet=a.worksheet||1,a.url="https://spreadsheets.google.com/feeds/cells/"+a.key+"/"+a.worksheet+"/public/basic?alt=json-in-script&callback=",delete a.key,delete a.worksheet}return this.parser=b.Parsers.GoogleSpreadsheet,this.params={type:"GET",url:a.url,dataType:"jsonp"},this},_.extend(b.Importers.GoogleSpreadsheet.prototype,b.Importers.Remote.prototype)}(this,_),function(a,_){var b=a.Miso||(a.Miso={});b.Parsers.Delimited=function(a,b){this.options=b||{},this.delimiter=this.options.delimiter||",",this._data=a,this.__delimiterPatterns=new RegExp("(\\"+this.delimiter+"|\\r?\\n|\\r|^)"+'(?:"([^"]*(?:""[^"]*)*)"|'+'([^"\\'+this.delimiter+"\\r\\n]*))","gi")},_.extend(b.Parsers.Delimited.prototype,b.Parsers.prototype,{_buildColumns:function(a,b){a._columns=[];var c=function(b,c,e){e=e||",";var f=null,g=0,h=!1,i=-1;while(f=b.exec(c)){var j=f[1];j.length&&j!==e?(h=!0,i=0):(h||g++,i++);var k=null;f[2]?k=f[2].replace(new RegExp('""',"g"),'"'):k=f[3],h?a._columns[i].data.push(k):a._columns.push(this._buildColumn({name:k,data:[]}))}return a};return c=_.bind(c,this),c(this.__delimiterPatterns,this._data,this.delimiter),this._addIdColumn(a,a._columns[0].data.length),a}})}(this,_)